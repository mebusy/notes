[](...menustart)

- [OpenSSL](#ee302fd5fd2a7a5a3c19fc5be21f979c)
    - [Misc](#74248c725e00bf9fe04df4e35b249a19)
- [RSA Public Key format](#967cf47a9ccbc9f0477ffe8ac2df05dd)
    - [Convert between different formats...](#b877b734093e9001b4572816c5ed60bd)
- [PEM Headers](#8767d9b0a0775bd3ce785aba5e9d78ce)
    - [Other convertion](#34590c775b79aa0219feabb60a77c6c8)

[](...menuend)


<h2 id="ee302fd5fd2a7a5a3c19fc5be21f979c"></h2>

# OpenSSL

```bash
# PKCS#8定义了在安全存储或传输私钥信息时，将私钥从密码学算法中分离出来的格式。
# Java中，通常使用PKCS#8格式的私钥来存储和传输私钥信息
OpenSSL> pkcs8 -topk8 -inform PEM -in app_private_key.pem -outform PEM -nocrypt -out app_private_key_pkcs8.pem 
```

如果要求 去掉 换行符

```bash
tr -d '\n' < public.txt
```


<h2 id="74248c725e00bf9fe04df4e35b249a19"></h2>

## Misc

random

```bash
$ openssl rand -base64 16
0qY8lqxWI/SQ1qGllLW+WA==
$ openssl rand -base64 8
IzOi8Mqq8tU=
```


<h2 id="967cf47a9ccbc9f0477ffe8ac2df05dd"></h2>

# RSA Public Key format

An RSA public key formatted by OpenSSH , can be generated by  `ssh-keygen`

> SSH keys are used for secure connections across a network. 

```bash
$ ssh-keygen -b 2048 -t rsa
```

```text
ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQB/nAmOjTmezNUDKYvEeIRf2YnwM9/uUG1d0BYsc8/tRtx+RGi7N2lUbp728MXGwdnL9od4cItzky/zVdLZE2cycOa18xBK9cOWmcKS0A8FYBxEQWJ/q9YVUgZbFKfYGaGQxsER+A0w/fX8ALuk78ktP31K69LcQgxIsl7rNzxsoOQKJ/CIxOGMMxczYTiEoLvQhapFQMs3FL96didKr/QbrfB1WT6s3838SEaXfgZvLef1YB2xmfhbT9OXFE3FXvh2UPBfN+ffE7iiayQf/2XR+8j4N4bW30DiPtOQLGUrH1y5X/rpNZNlWW2+jGIxqZtgWg7lTy3mXy5x836Sj/6L
```

> usually they are all in one line

The standard ssh2 file format for use in Secure Shell

`-e` : The default export format is “RFC4716”

```bash
$ ssh-keygen -b 2048 -t rsa -e

---- BEGIN SSH2 PUBLIC KEY ----
Comment: "2048-bit RSA, ..."
AAAAB3NzaC1yc2EAAAABJQAAAQB/nAmOjTmezNUDKYvEeIRf2YnwM9/uUG1d0BYs
c8/tRtx+RGi7N2lUbp728MXGwdnL9od4cItzky/zVdLZE2cycOa18xBK9cOWmcKS
0A8FYBxEQWJ/q9YVUgZbFKfYGaGQxsER+A0w/fX8ALuk78ktP31K69LcQgxIsl7r
NzxsoOQKJ/CIxOGMMxczYTiEoLvQhapFQMs3FL96didKr/QbrfB1WT6s3838SEaX
fgZvLef1YB2xmfhbT9OXFE3FXvh2UPBfN+ffE7iiayQf/2XR+8j4N4bW30DiPtOQ
LGUrH1y5X/rpNZNlWW2+jGIxqZtgWg7lTy3mXy5x836Sj/6L
---- END SSH2 PUBLIC KEY ----
```

The same public key formatted as an RSA public key (note the five -, and no space):

```text
-----BEGIN RSA PUBLIC KEY-----
MIIBCgKCAQEA+xGZ/wcz9ugFpP07Nspo6U17l0YhFiFpxxU4pTk3Lifz9R3zsIsu
ERwta7+fWIfxOo208ett/jhskiVodSEt3QBGh4XBipyWopKwZ93HHaDVZAALi/2A
+xTBtWdEo7XGUujKDvC2/aZKukfjpOiUI8AhLAfjmlcD/UZ1QPh0mHsglRNCmpCw
mwSXA9VNmhz+PiB+Dml4WWnKW/VHo2ujTXxq7+efMU4H2fny3Se3KYOsFPFGZ1TN
QSYlFuShWrHPtiLmUdPoP6CV2mML1tk+l7DIIqXrQhLUKDACeM5roMx0kLhUWB8P
+0uj1CNlNN4JRZlC7xFfqiMbFRU9Z4N6YwIDAQAB
-----END RSA PUBLIC KEY-----
```

> The "RSA PUBLIC KEY" format was used in very early SSLeay, which evolved into OpenSSL, but obsoleted before 2000
> Although this format is long obsolete, **OpenSSL still supports** it.

openssl  x.509 public key, which looks like this:

```text
-----BEGIN PUBLIC KEY-----
...
-----END PUBLIC KEY-----
```

---

`RSA PUBLIC KEY` is closer to the content of a `PUBLIC KEY`.

"RSA PUBLIC KEY" format is the RSA-specific format from PKCS#1, whereas "PUBLIC KEY" is the X.509 generic structure that handles numerous (and extensible) algorithm. 



<h2 id="b877b734093e9001b4572816c5ed60bd"></h2>

## Convert between different formats...

**The ssh-keygen utility is used to covert SSH keys between the different formats.**

- convert to OpenSSH format.
    - `-i` : this option will read an unencrypted private (or public) key file in the format specified by the -m option and print an OpenSSH compatible private (or public) key to stdout.
        - The default **import** format is “RFC4716”(SSH2).
    ```bash
    # -mPKCS8  to specify the input format
    ssh-keygen -f pub1key.pub -i -mPKCS8
    ```

> -m key_format Specify a key format for the -i (import) or -e (export) conversion options. The supported key formats are: “RFC4716” (RFC 4716/SSH2 public or private key), “PKCS8” (PEM PKCS8 public key) or “PEM” (PEM public key). The default conversion format is “RFC4716”.

- to convert OpenSSH format(ssh-rsa) to SSH2 format
    - `-e`: read a private or public OpenSSH key file and print to stdout a public key in one of the formats specified by the -m option
        - The default **export** format is “RFC4716”(SSH2).
    ```bash
    ssh-keygen -e -f ./openssh.pub
    ```

<h2 id="8767d9b0a0775bd3ce785aba5e9d78ce"></h2>

# PEM Headers 

PEM Header | Pub/Priv | Format 
--- | --- | ---
BEGIN RSA PUBLIC KEY | Public | PKCS#1 RSA 
BEGIN RSA PRIVATE KEY | Private | PKCS#1 RSA
BEGIN PUBLIC KEY | Public | X.509 
BEGIN PRIVATE KEY | Private | PKCS#8 
BEGIN ENCRYPTED PRIVATE KEY | Private | PKCS#8 Encrypted


format | for 
--- | ---
PKCS#1  | traditional format for RSA keys
PKCS#8  | foramt any private key
X.509 | format for any public key


- convert between PKCS#1 and PKCS#2
    ```basn
    # #1 -> #8
    openssl pkcs8 -in private-pkcs1.pem -topk8 -out private-pkcs8.pem -nocrypt
    openssl pkcs8 -in private-pkcs1.pem -topk8 -out private-pkcs8-enc.pem
    ```
    ```bash
    # #8 -> #1
    openssl rsa -in private-pkcs8.pem -out private-pkcs1.pem
    ```

<h2 id="34590c775b79aa0219feabb60a77c6c8"></h2>

## Other convertion

Convert RSA public key between X.509 and PKCS #1 formats

```bash
openssl rsa -pubin -in public.pem -RSAPublicKey_out
openssl rsa -RSAPublicKey_in -in pkcs1-public.pem -pubout
```

Extract public key from RSA private key

```bash
openssl rsa -in private.pem -out public.pem -pubout
```

Extract public key from X.509 CSR

```bash
openssl req -in cert.csr -pubkey -noout
```

Extract public key from X.509 certificate

```bash
openssl x509 -in cert.crt -inform pem -pubkey -noout
openssl x509 -in cert.cer -inform der -pubkey -noout
```

Convert X.509 certificate between DER and PEM formats (done.)

```bash
openssl x509 -in cert.cer -inform der -out cert.crt -outform pem
openssl x509 -in cert.crt -inform pem -out cert.cer -outform der
```

---

[SSH协议中的非对称加密](https://blog.csdn.net/m0_46573836/article/details/108900752)

[彻底搞懂HTTPS的加密原理](https://zhuanlan.zhihu.com/p/43789231)

[HTTPS用的是对称加密还是非对称加密](https://zhuanlan.zhihu.com/p/96494976)

[HTTPS用的是对称加密还是非对称加密](https://www.cnblogs.com/lfri/p/12593232.html)

**利用私钥加密的过程，其实就是在对数据进行签名，所以也叫数字签名**



