
[TOC]

# é€»è¾‘å›å½’  Logistic Regression

##### é€»è¾‘å›å½’å…¶å®æ˜¯åˆ†ç±»é—®é¢˜ Classification

##### ä¸‹é¢è®¨è®ºéƒ½æ˜¯`äºŒå…ƒåˆ†ç±»`é—®é¢˜ï¼Œå³ç›®æ ‡å€¼åªæœ‰`0,1` ä¸¤ç§å¯èƒ½

## æ¨¡å‹ : h(x) = g(Î˜áµ€x)

##### logisticå›å½’å®è´¨ä¸Šè¿˜æ˜¯çº¿æ€§å›å½’æ¨¡å‹

æˆ‘ä»¬åœ¨ çº¿æ€§å›å½’çš„è¿ç»­å€¼ ç»“æœä¸ŠåŠ  ä¸€å±‚å‡½æ•°æ˜ å°„ g, å°†è¿ç»­å€¼æ˜ å°„åˆ°ç¦»æ•£å€¼0/1ä¸Š

```
h(x) = g(Î˜áµ€x)
```

å…¶ä¸­,

![](http://latex.codecogs.com/gif.latex?g%28z%29=%5Cfrac%7B1%7D%7B1&plus;%20e%5E%7B-z%7D%7D)

å®Œæ•´çš„å‡è®¾å‡½æ•°å¦‚ä¸‹ï¼š

![][1]


g(z) ç§°ä¸º Så‹å‡½æ•° Sigmoid function æˆ– é€»è¾‘å‡½æ•° Logistic function

g(z)çš„å‡½æ•°å›¾åƒå¦‚ä¸‹ï¼š

![](http://images.cnitblog.com/blog/392228/201410/311940295342017.jpg)

å½“zè¶‹è¿‘äº-âˆï¼Œg(z)è¶‹è¿‘äº0ï¼Œè€Œzè¶‹è¿‘äºâˆï¼Œg(z)è¶‹è¿‘äº1ï¼Œä»è€Œè¾¾åˆ°åˆ†ç±»çš„ç›®çš„ã€‚

æ•´æ¡æ›²çº¿å‘ˆSå‹, è¿™ä¹Ÿæ˜¯ "Så‹" å«æ³•çš„ç”±æ¥ã€‚


##### é€»è¾‘å›å½’çš„å‡è®¾å‡½æ•°h(x)çš„è¾“å‡ºï¼Œæ˜¯ y=1çš„æ¦‚ç‡çš„ä¼°è®¡å€¼

```
h(x) = P( y=1|x;Î˜ )
P( y=1|x;Î˜ ) + P( y=0|x;Î˜ ) = 1
```

## å†³ç­–è¾¹ç•Œ  decision boundary

å†³ç­–è¾¹ç•Œ æ˜¯å‡è®¾å‡½æ•°çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒåŒ…å«å‚æ•° Î˜

æˆ‘ä»¬è§‚å¯Ÿ g(z)çš„å‡½æ•°å›¾ , å¯ä»¥çœ‹åˆ°

  - å½“ z>=0, ä¹Ÿå³ Î˜áµ€x >= 0 æ—¶ï¼Œ å‡½æ•°å€¼ >= 0.5
  - å½“ z< 0, ä¹Ÿå³ Î˜áµ€x <  0 æ—¶ï¼Œ å‡½æ•°å€¼ < 0.5
  - å½“ Î˜ ç¡®å®šå, Î˜áµ€x çš„å›¾åƒå°±æ˜¯ å†³ç­–è¾¹ç•Œ
  - éçº¿æ€§å†³ç­–è¾¹ç•Œï¼Œéœ€è¦å€ŸåŠ©å¤šé¡¹å¼

## ä»£ä»·å‡½æ•° cost function J

##### é€»è¾‘å›å½’ J åº”è¯¥æ˜¯ä¸ª`å‡¸å‡½æ•° convex` ï¼Œ çº¿æ€§å›å½’çš„J æ˜¯`éå‡¸å‡½æ•°`

```
J(Î˜)= 1/m âˆ‘ cost( h(x) , y )
```

![](http://latex.codecogs.com/gif.latex?cost%28%20h_%5Ctheta%28x%29%2Cy%29%3D%5Cbegin%7Bcases%7D%20-log%28h_%5Ctheta%28x%29%29%20%26%20%5Ctext%7B%20if%20%7D%20y%3D%201%5C%5C%20-log%281-h_%5Ctheta%28x%29%29%20%26%20%5Ctext%7B%20if%20%7D%20y%3D0%20%5Cend%7Bcases%7D)

`ç‰¹ç‚¹`:

 - å¦‚æœ h(x)=y, é‚£ä¹ˆ cost(h(x),y)=0  ( y=[0,1] )
 - å¦‚æœ y=0 ,  h(x)->1 ,  é‚£ä¹ˆ cost(h(x),y) -> âˆ
 - å¦‚æœ y=1 ,  h(x)->0 ,  é‚£ä¹ˆ cost(h(x),y) -> âˆ
 
æ‹†æˆä¸¤ä¸ªç­‰å¼ éå¸¸ä¸åˆ©äºè®¡ç®—ï¼Œåˆ©ç”¨ y åªèƒ½å–0å’Œ1çš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠcost function ç®€åŒ–ä¸ºä¸€ä¸ªç­‰å¼

```
cost(h(x),y) = -ylog( h(x) ) -(1-y)log( 1-h(x) )
```

æœ€ç»ˆæˆ‘ä»¬è·å¾—å®Œæ•´çš„ä»£ä»·å‡½æ•°:

```
J(Î˜)= -1/m âˆ‘[ ylog( h(x) ) + (1-y)log( 1-h(x) ) ]
```

![][1]


## æ¢¯åº¦ä¸‹é™


è¿­ä»£å…¬å¼å’Œ çº¿æ€§å›å½’åŸºæœ¬ä¸€æ ·ï¼Œå”¯ä¸€åŒºåˆ«å°±æ˜¯ h(x) ä¸åŒã€‚

ï¼Ÿä¸ºä»€ä¹ˆå…¬å¼åŸºæœ¬ä¸€æ ·ï¼Ÿ å› ä¸ºè¿™åªæ˜¯ h(x) å’Œ y ä¹‹é—´çš„æ¯”è¾ƒï¼Ÿ

![](http://latex.codecogs.com/gif.latex?%5Ctheta_j%20%3A%3D%20%5Ctheta_j%20-%20%5Calpha%5Cfrac%7B1%7D%7Bm%7D%5Csum_%7Bi%3D1%7D%5E%7Bm%7D%28h_%5Ctheta%28x%5E%7B%28i%29%7D%29-y%5E%7B%28i%29%7D%29%5Ccdot%20x_%7Bj%7D%5E%7B%28i%29%7D)

![](http://latex.codecogs.com/gif.latex?%5Ctheta%3A%3D%5Ctheta-%5Calpha%5Cfrac%7B1%7D%7Bm%7D%5Csum_%7Bi%3D1%7D%5E%7Bm%7D%5B%28h_%5Ctheta%28x%5E%7B%28i%29%7D%29-y%5E%7B%28i%29%7D%29%5Ccdot%20x%5E%7B%28i%29%7D%20%5D)


## é«˜çº§ä¼˜åŒ–

##### ä¼˜ç‚¹
  - ä¸éœ€è¦æ‰‹åŠ¨é€‰æ‹©ğ›¼
  - ä¸€èˆ¬æ¯”æ¢¯åº¦ä¸‹é™ç®—æ³•å¿«

##### ç¼ºç‚¹
  - æ›´åŠ å¤æ‚

### ç”¨æ³•

```
% å‡è®¾ æœ‰ä¸¤ä¸ªÎ˜â‚€ Î˜â‚ å‚æ•°

% é¦–å…ˆå®šä¹‰ä¸€ä¸ªcostFunction, è¿”å›J å’Œ ä¸€ä¸ªæ¢¯åº¦å€¼
function [jVal , gradient] = costFunction( theta )
    jval = % è®¡ç®—ä»£ä»·å‡½æ•° J(Î˜)
    
    gradient = zeroes(2,1) ;
    gradient[1] = % J(Î˜) å¯¹ Î˜â‚€ çš„åå¯¼æ•°
    gradient[2] = % J(Î˜) å¯¹ Î˜â‚ çš„åå¯¼æ•°
end

% æœ‰äº†è¿™ä¸ª costFunctionä¹‹åï¼Œå°±å¯ä»¥

options = optimset( 'GradObj' , 'on' , 'MaxIter' , '100' );
initialTheta = zeros( 2,1 );  % Î˜ åˆå§‹å€¼
[optTheta, functionVal, exitFlag] ...
    = fminunc(@costFunction , initialTheta , options );
```

# å¤šç±»åˆ†ç±»

## 1-vs-all åˆ†ç±»æ€æƒ³

ä¾‹å­ï¼š

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè®­ç»ƒé›†ï¼Œæœ‰ä¸‰ä¸ªç±»åˆ«ã€‚

æˆ‘ä»¬è¦åšçš„ï¼Œå°±æ˜¯å°†å…¶åˆ†æˆ3ä¸ªäºŒå…ƒåˆ†ç±»é—®é¢˜ã€‚

```
hâ±(x) = P( y=i | x; Î˜ )   (i=1,2,3)
```

TODO:  ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œ3ä¸ª0,1, æ€ä¹ˆåˆæˆä¸€ä¸ª 1,2,3

# review :

##### å’Œçº¿æ€§å›å½’ä¸€æ ·ï¼Œæ‹Ÿåˆæ›²çº¿ï¼Œéœ€è¦å¤šé¡¹å¼

##### h(x) = g( Î¸áµ€x ) , Î¸áµ€x å›¾åƒå¯ä»¥çœ‹åˆ°å†³ç­–è¾¹ç•Œ

##### é€»è¾‘å›å½’çš„ ä»£ä»·å‡½æ•° J æ€»æ˜¯ä¸ªå‡¸å‡½æ•°


# ä¸€èˆ¬æµç¨‹

##### å¯è§†åŒ–

```
function plotData(X, y)

    % Create New Figure
    figure; hold on;

    pos = find(y==1); neg = find(y == 0);

    % Plot Examples
    plot(X(pos, 1), X(pos, 2), 'k+','LineWidth', 2, 'MarkerSize', 7);
    plot(X(neg, 1), X(neg, 2), 'ko', 'MarkerFaceColor', 'y',   'MarkerSize', 7);
     
end

```

---
---

  [1]: http://latex.codecogs.com/gif.latex?h_%5Ctheta%28x%29%3D%5Cfrac%7B1%7D%7B1&plus;%20e%5E%7B-%5Ctheta%5E%7BT%7Dx%7D%7D


